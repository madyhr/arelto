# Arelto
[Arelto Trailer](https://github.com/user-attachments/assets/5101cb45-c6c6-4dc1-a29d-d21d82417f72)

A Reinforcement Learning Rogue-Lite (RL2) game where the enemies get smarter over time. Try to survive for as long as you can!

## Prerequisites

Before installing, ensure you have the following system dependencies installed and *that you are using an [NVIDIA GPU](https://developer.nvidia.com/cuda/gpus)*[^1].

### Linux
#### Debian/Ubuntu
```bash
sudo apt update
sudo apt install cmake build-essential python3-dev
sudo apt install libsdl2-dev libsdl2-image-dev libsdl2-ttf-dev libsdl2-mixer
sudo apt install libomp-dev
```

#### Arch
```bash
sudo pacman -S cmake base-devel python sdl2 sdl2_image sdl2_ttf sdl2_mixer
```

> [!NOTE]
> Windows and macOS are currently not supported.


### Python
- Python 3.10 or higher.

## Installation

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/madyhr/arelto.git
    cd arelto
    ```

2. **Fetch external dependencies:**
    ```bash
    git submodule update --init --recursive
    ```

3.  **Create a virtual environment (Recommended):**
    ```bash
    python3 -m venv venv
    source venv/bin/activate
    ```

4.  **Install the game as a package:**
    ```bash
    pip install .
    ```
    *Note: This process may take some time as it downloads all dependencies and compiles the C++ backend.*

## Running the Game

To start the game with the asynchronous agent (default experience):

```bash
python scripts/start_game_async.py
```

Alternatively, there is also a synchronous agent variant. However, the game pauses during policy updates, so it is also not as smooth an experience.

```bash
python scripts/start_game.py
```

## How to play

### Game state management 

- **Exiting**: Press the `q` key to quit and close the game.

- **Restarting**: Press the `ESC` key to go back to the main menu.

- **Pausing**: Press the `p` key to pause the game. 

- **Respawn**: If you have died, you can press the `r` key to respawn.

### Gameplay

- **Movement**: Use `WASD` to move the character around. 

- **Actions**: Use `MB1` to shoot a `Fireball` or `MB2` to shoot a `Frostbolt` towards the cursor. 

- **Leveling up**: Once you gather enough experience points, you will be given a choice between 3 upgrades.


## Development

### Building
For development, it is recommended that you use `cmake` instead of `pip`:

```bash
cmake -B build -G Ninja -DCMAKE_INSTALL_PREFIX=.
```

```bash
ninja -C build install
```

In the case that you have already installed `arelto` as a package in your virtual environment, you may want to explicitly set the `PYTHONPATH`.
```bash
# If you are in path/to/arelto/:
EXPORT PYTHONPATH=$PWD
```

### Tests
- **Running Tests:**
    #### Python tests
    ```bash
    python -m pytest tests
    ```

    #### C++ tests
    ```bash
    ./build/arelto_tests
    ```
> [!NOTE]
> The C++ tests require you build using `cmake` as described in the Development section.

## Generative AI Disclaimer

All the digital assets used in this project have been generated by [Nano Banana Pro](https://deepmind.google/models/gemini-image/pro/). Some light editing was afterwards done in [Pinta](https://www.pinta-project.com/) to move around the different assets, remove backgrounds and organize them into more easily usable texture maps.
- - -
[^1]: An NVIDIA GPU is required as the default experience using an asynchronous learning agent. Here the training and inference are both run on the GPU in parallel CUDA streams, while the game itself runs on the CPU. This is to create a smooth gameplay experience while also being able to train the agent in a reasonable amount of time.
